# Chapter4 EEG中常见的干扰与伪迹

——by 李世虔整理，仅供学习参考，如有勘误，请联系邮箱：devount@qq.com

[TOC]


## 一、EEG中常见的伪迹
EEG信号是随时间变化的随机信号，且幅值很小（通常是微伏uV级别），极易受到与脑活动无关的其他信号干扰，这些信号称为伪迹，本节将逐一介绍这些伪迹。
### 1.1 眼电伪迹
眼电伪迹是EEG信号中最常见的伪迹，其可以大致分为**眨眼伪迹**与**眼动伪迹**，是指由眼球的运动带来的电势差变化，眼球可以简化为一个前面（面部方向）电位为正，后面（脑内方向）电位为负的球体，造成这种前后电位差的**电荷对**称为**偶极子（dipole）**,这个偶极子的电势差从前往后逐渐减弱，因此在靠近面部的额叶部位的EEG信号会受到该偶极子的较大影响，当没有眨眼或眼球运动时，该偶极子的电势较为恒定，可以通过滤波等手段去除。
#### 1.1.1 眨眼伪迹
当眨眼时，眼睑覆盖眼球然后再离开眼球，这会导致偶极子电势差的急剧变化，该种电势差变化被EEG采集系统捕捉，便形成了眨眼伪迹。图1所示是典型的眨眼伪迹，**其中1和2是在Fp1电极上记录到的眨眼伪迹，其特征是波形有一个很窄的尖峰，且幅值很大，随着电极排布位置的靠后，其幅值会逐渐变小，且尖峰的时间范围也会变宽，如3所示。**

 ![眨眼](./Artifact/Blink.png) 

<center> 图1 眨眼伪迹波形</center>

眨眼伪迹一般用垂直眼电记录（VEOG），但也可以用Fp1、Fp2以及FpZ处的EEG信号代替，不过会损失几个通道的脑电数据。
#### 1.1.2 眼动伪迹
眼动伪迹是眼球上下或左右运动带来的偶极子电势差变化，眼球运动方向的电位会变得更正。快速的眼球运动一般称为眼跳（saccade），在实验中眼跳的典型过程是从一个注视位置跳到另一个注视位置，然后再跳转回原来位置，这会导致一个类似方波的“篷车”或“斜篷车”波形，如下图所示。眼动伪迹一般通过放置在眼睛左右的电极（HEOG，水平眼电）进行记录。

![眼动](./Artifact/eyemovement.png)

<center> 图2 眼动伪迹波形</center>

### 1.2 肌电伪迹
 肌电伪迹来源于肌肉活动时肌肉细胞的电位变化，由于EEG在头皮进行采集，因此头部和颈部的肌肉活动是EEG肌电干扰的最主要来源，颈部以下的肌肉活动一般不会对EEG产生较大的干扰。肌电EMG信号一般频率较高，在25Hz以上，幅度较大，表现出爆发式的密集波形，被试的咬牙、吞咽、打哈欠等活动均会产生明显的肌电伪迹，如图3所示。

![肌电](./Artifact/muscle.png)

<center> 图3 肌电伪迹波形 </center>

### 1.3 心电伪迹
心电伪迹（ECG）是由心脏跳动带来的，容易在乳突出现，如果以乳突作为参考电极的话，那么ECG会以颠倒的形状在所有电极中观察到。虽然有时可以通过稍微移动乳突或耳垂参考电极来减小ECG，但是一般不能完全消除，在时域中表现为QRS波，一般通过ICA算法去除，如图4所示[^1]。

 ![心电](./Artifact/ECG.webp)

<center> 图4 心电伪迹时域波形 </center>

由于心电幅值一般不大，如果不使用乳突电极则不易在时域中发现，因此可以转为频域后再进行观察，心电伪迹的频率一般为1Hz，可以在频域中明显看到，如图5所示[^2]，在低频上具有较为明显的峰值。

![心电频域](./Artifact/ECG_fre.jpg)

<center> 图5 心电伪迹频域波形  </center>

### 1.4 直流偏移与工频干扰
#### 1.4.1 直流偏移
直流偏移（DC Offset）是由EEG采集系统中的放大器带来的，为了存储EEG信号电压的负值，在一些EEG系统中将信号整体**迭代**偏移了几千微伏，造成EEG信号逐渐向上偏转，在分析时需要首先使用高通滤波器去除DC Offset，高通滤波器的频率一般是0.5Hz，但不同的设备有不同的建议频率，需要查看用户手册。如图6所示为使用OpenBCI脑电仪采集的EEG信号,可以看到上方的原始信号逐渐向上偏移，使用0.5Hz的带通滤波器后下方的信号逐渐上升的趋势已经被消除了。

![DC offset](./Artifact/DCOffset.png)

<center> 图6 DC Offset </center>

#### 1.4.2 工频干扰
工频干扰也叫市电干扰、交流电干扰、线路噪声（line noise）等，是由于交流电通过空间耦合到EEG信号中造成的干扰，其频率与市电的频率一致，一般还伴随着谐波，在我国使用的市电是50Hz,因此工频干扰也是50Hz的，其谐波干扰频率一般是50Hz的整数倍。当电极由于头皮油脂、脏污、角质层过厚等导致阻抗较高时，更容易引入工频干扰。其在时域中表现为整体的极高频，使得信号看起来像是“一整块”，淹没了信号的细节。如图7所示,上方是未去除工频干扰的时域波形图，下方是使用50Hz的陷波滤波器去除工频干扰后的时域波形图，可以发现，信号变得“干净”了许多。

![Line Noise](./Artifact/LineNoise.png)

<center> 图7 工频干扰（时域） </center>

在频域中，工频干扰更易发现，其表现为在50Hz处的极高峰，当去除工频干扰后，该峰值会被去掉，如图8所示。

![Line Noise](./Artifact/LineNoise_fre.png)

<center> 图8 工频干扰（频域） </center>

### 1.5 皮肤慢电位
当被试出汗，导致某些电极的电阻降低时，根据欧姆定律会导致电压的升高，从而出现皮肤慢电位伪迹，由于电阻降低的过程较为缓慢，因此皮肤慢电位的频率比较低（0.2-0.5Hz），其表现为较慢的波形飘移，一般通过高通滤波可以去除。如图9所示[^1]。

![皮肤慢电位](Artifact/skin.webp)

<center> 图9 皮肤慢电位  </center>

### 1.6 放大器饱和
缓慢的波形飘移有时会使得记录到的EEG信号超过放大器能记录的最大值，造成放大器的饱和，也叫做阻塞（block），在时域波形上表现为一条直线。如果在实验中经常出现该现象，则应该适当降低放大器对原始信号的放大倍数（放大器增益）。如图10所示[^1] 。

![放大器饱和](.\Artifact\block.webp) 

<center> 图10 放大器饱和 </center>

## 二、常用的伪迹去除方法

伪迹的去除包括实验前、实验中、实验后三个过程。

### 2.1 实验前的伪迹去除
良好的实验设计和实验环境可以极大程度减少实验中的伪迹，在实验前首先应该完善好实验的指导语以及练习程序，确保实验过程中被试不会因为实验流程而产生困惑，中途说话询问等。

其次招募被试时应该告知被试保持良好的休息和习惯，不会在实验中犯困打哈欠和做一些不必要的动作如摇头、蹙眉、咬手指等。

最后，应该准备好屏蔽良好、安静的实验环境，不会在实验中有人进出、交谈，以及使用电子产品等。这些步骤可以极大的避免不必要的环境伪迹。

### 2.2 实验中的伪迹去除
在实验中，主试应该严格按照实验要求，通过让被试洗头、适当涂抹脑电膏、使用扎带固定电极帽位置等尽量降低电极的阻抗，并实时的监控实验过程，记录实验中出现的较为明显的伪迹，如被试调整坐姿移动、说话、打哈欠等，这些步骤可以为后期伪迹的去除进行准确的归因和时间定位，减少伪迹。

### 2.3 实验后的伪迹去除
实验后的伪迹去除，主要有两种方式：**伪迹排除**与**伪迹校正**。
#### 2.3.1 伪迹排除
伪迹排除，即删除具有伪迹的信号段，通常会设置一个排伪阈值，当幅值高于此阈值时便将该段信号丢弃。此种方法去除伪影快速、干净，但会损失原始数据，当信号中含有伪影的片段较多时，删除伪影片段会造成数据的大量流失，导致用于分析的数据不足。
#### 2.3.2 伪迹校正
伪迹校正，即用校正算法大幅降低伪影的幅值，同时保持认知脑电的幅值不变。 此种方法理论上讲非常完美，但在实践中由于伪迹的多样化和复杂化，很难有一个完美的算法能同时兼顾去除伪迹和保持认知脑电不变两项功能。通常在使用该方法时就已做好接受数据部分失真的准备，但在现阶段，该方法依然是最有潜力的方法，本节将简要介绍此种方法。

使用**附加电极**专门记录伪迹信号是一种较为常用的方法，如垂直眼电和水平眼电记录了眨眼和眼动伪迹，然后从EEG信号中减去这些伪迹，便能得到不包括眼电伪迹的信号。

**滤波**也是伪迹去除的重要手段，使用高通滤波可以去除信号中的直流飘移和皮肤慢电位，使用陷波滤波可以去除工频干扰

伪迹校正中最著名的算法是**独立成分分析算法（Independent Component Analysis，ICA）**，该算法假设在每一个电极处采集到的信号实际上包括着所有电极所在位置的脑电信息和伪迹信息，且这些信息相互独立，但由于距离原因，其他电极处的脑电信号在到达该电极时已经有了衰减，因此可以通过算法来将每个电极的信号分解成不同的成分（components)，然后从这些成分中去除掉伪迹成分，在将其合成为新的信号，这个信号中便只留下了有用的脑电信息。ICA常用于心电和眼电伪迹的去除。


## 三、 推荐阅读
- 《事件相关电位基础》 --Luck等著

- 《EEG脑电信号分析方法及其应用》 --李颖洁等著

[^1]: 全面总结EEG信号中常见的干扰和噪声信号.https://mp.weixin.qq.com/s/iCJvt0TU6TgpJQnNHGS9Iw
[^2]: EEG中如何鉴别心电干扰信号.https://zhuanlan.zhihu.com/p/348979264